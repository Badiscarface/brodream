import React from "react";
import {
  Box,
  Button,
  Collapse,
  Grid,
  Typography,
  Stack,
  useTheme,
} from "@mui/material";
import Image from "next/image";
// hooks
import { useCurrencyFormatter } from "@/hooks/formatCurrency";
import { capitalize } from "lodash";
import toast from "react-hot-toast";

interface Option {
  name: string;
  cover: { url: string };
  price: number;
}

export default function MarkingSelector({ ...props }) {
  const {
    category,
    quantity,
    priceSale,
    totalPrice,
    markingType,
    handleMarkingTypeSelect,
    markingLocations,
    handleMarkingLocationSelect,
    selectedColor,
  } = props;
  const { embroidery, embroideryPositions, printing, printingPositions } =
    category;
  const theme = useTheme();

  const fCurrency = useCurrencyFormatter();
  return (
    <Box pb={3}>
      {/* Marking Type */}
      {!(embroidery || printing) ? null : (
        <Typography
          variant="subtitle1"
          color="text.secondary"
          sx={{
            mt: 2,
            mb: 1,
            textTransform: "uppercase",
          }}
        >
          SÉLECTIONNEZ LE TYPE DE MARQUAGE
        </Typography>
      )}
      <Stack gap={2} direction="row">
        {printing && (
          <Stack gap={1} alignItems={"center"}>
            <Button
              variant={"contained"}
              onClick={() => {
                if (!selectedColor) {
                  toast.error("Veuillez d'abord sélectionner la couleur.");
                  return;
                }
                handleMarkingTypeSelect("printing");
              }}
              color={markingType === "printing" ? "primary" : "inherit"}
              sx={{
                textTransform: "none",
                border:
                  "1px solid " +
                  (markingType === "printing"
                    ? "transparent"
                    : theme.palette.divider),
                display: "flex",
                flexDirection: "column",
                alignItems: "center",
                width: "123px",
                boxShadow:
                  markingType === "printing"
                    ? theme.customShadows.primary
                    : "none",
                height: "123px!important",
              }}
            >
              <svg
                width="75"
                height="80"
                viewBox="0 0 75 80"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M48.5592 0.234375C47.8121 0.515625 46.8014 1.65625 46.5963 2.4375C46.5084 2.76562 46.4352 3.9375 46.4352 5.03125V7.03125L25.3121 7.0625L4.17443 7.10938L3.29552 7.54688C2.13829 8.125 1.01036 9.32812 0.48302 10.5312L0.0728638 11.4844V18.75V26.0156L0.497669 26.9844C0.995715 28.1562 2.13829 29.375 3.25157 29.9219C3.67638 30.1406 4.11583 30.3125 4.21837 30.3125C4.35021 30.3125 4.39415 32.5781 4.39415 41.0938V51.875H2.5631C0.805286 51.875 0.702747 51.8906 0.365833 52.2656C-0.0736206 52.7188 -0.117566 53.5156 0.219348 54.9219C0.717395 57.0156 2.00646 58.9219 3.63243 60L4.39415 60.5V66.8125C4.39415 71.75 4.35021 73.125 4.21837 73.125C3.76427 73.125 2.41661 73.9688 1.69884 74.6875C0.76134 75.625 0.146106 76.9688 0.0435669 78.2812C-0.0296752 79.1094 -0.000378376 79.2344 0.336536 79.5938L0.717395 80H7.69005H14.6627L15.0436 79.5938C15.3951 79.2188 15.4098 79.125 15.3219 78.2344C15.1315 76.2812 13.9156 74.4375 12.2311 73.5781C11.7477 73.3281 11.2643 73.125 11.1764 73.125C11.0299 73.125 10.986 71.8281 10.986 67.1875V61.25L33.3541 61.2188L55.7369 61.1719L56.5719 60.8281C58.9449 59.8594 60.5123 58.1875 61.4205 55.6562C61.7428 54.7812 61.7428 54.6562 61.7867 42.6094L61.8307 30.4688H62.9147H64.0133V51.7969C64.0133 68.75 63.9694 73.125 63.8375 73.125C63.3834 73.125 62.0358 73.9688 61.318 74.6875C60.3805 75.625 59.7652 76.9688 59.6627 78.2812C59.5895 79.1094 59.6188 79.2344 59.9557 79.5938L60.3365 80H67.3092H74.2819L74.6627 79.5938C75.0143 79.2188 75.0289 79.125 74.941 78.2344C74.7506 76.2812 73.5348 74.4375 71.8502 73.5781C71.3668 73.3281 70.8834 73.125 70.7955 73.125C70.649 73.125 70.6051 68.7344 70.6051 51.7188C70.6051 34.7031 70.649 30.3125 70.7955 30.3125C70.8834 30.3125 71.3668 30.1094 71.8502 29.8594C72.9488 29.2969 73.9889 28.1719 74.5162 26.9531L74.9264 26.0156V18.75V11.4844L74.4723 10.4688C73.8863 9.17188 72.9781 8.20312 71.777 7.59375L70.8248 7.10938L66.3278 7.0625L61.816 7.01562V5.04688C61.816 3.9375 61.7428 2.79688 61.6403 2.4375C61.3912 1.57812 60.3072 0.390625 59.5455 0.171875C58.608 -0.09375 49.3063 -0.046875 48.5592 0.234375ZM59.2526 2.73438C59.6041 3.09375 59.6188 3.20312 59.6188 5.07812V7.03125H54.1256H48.6324V5.07812C48.6324 3.20312 48.6471 3.09375 48.9986 2.73438L49.3502 2.34375H54.1256H58.901L59.2526 2.73438ZM8.78868 18.75V28.125H6.92833C5.88829 28.125 4.80431 28.0469 4.49669 27.9531C3.72032 27.7344 2.5631 26.5 2.35802 25.7031C2.13829 24.8594 2.13829 12.6562 2.35802 11.8125C2.5631 11.0312 3.57384 9.89062 4.32091 9.60938C4.70177 9.46875 5.56603 9.39062 6.85509 9.375H8.78868V18.75ZM64.0133 15.2344V21.0938H37.4996H10.986V15.2344V9.375H37.4996H64.0133V15.2344ZM71.2057 9.92188C71.5572 10.1875 72.0406 10.7031 72.2897 11.0781L72.7291 11.75L72.7731 18.3281C72.817 25.875 72.817 25.9375 71.7916 27.0312C70.9127 27.9531 70.3414 28.125 68.0563 28.125H66.2106V18.7344V9.34375L68.3932 9.40625C70.5611 9.45312 70.5904 9.45312 71.2057 9.92188ZM13.1832 25.7812V28.125H12.0846H10.986V25.7812V23.4375H12.0846H13.1832V25.7812ZM59.5895 38.9375L59.5455 54.4531L59.1354 55.4062C58.608 56.6094 57.4801 57.8125 56.3229 58.3906C55.5611 58.7656 55.2535 58.8281 54.1256 58.8281C52.9977 58.8281 52.6901 58.7656 51.9283 58.3906C50.1412 57.5 48.8815 55.6406 48.6764 53.5781C48.6031 52.8438 48.5006 52.5 48.2516 52.2344L47.9147 51.875H31.6402H15.3805V37.6562V23.4375H37.4996H59.6188L59.5895 38.9375ZM64.0133 25.7812V28.125H62.9147H61.816V25.7812V23.4375H62.9147H64.0133V25.7812ZM8.78868 39.6094V48.7656L9.1549 49.1406C9.609 49.6406 10.1656 49.6406 10.6197 49.1406L10.986 48.7656V39.6094V30.4688H12.0846H13.1832V41.1719V51.875H9.88732H6.59142V41.1719V30.4688H7.69005H8.78868V39.6094ZM68.4078 51.7188V72.9688H67.3092H66.2106V51.7188V30.4688H67.3092H68.4078V51.7188ZM46.5817 54.5312C46.5817 55.3281 47.4313 57.2656 48.2955 58.4062L48.6764 58.9062L27.524 58.875L6.37169 58.8281L5.49279 58.3906C4.35021 57.8281 3.29552 56.7188 2.76818 55.5469C2.5338 55.0312 2.34337 54.5156 2.34337 54.4062C2.34337 54.2656 6.86974 54.2188 24.4625 54.2188C46.3473 54.2188 46.5817 54.2188 46.5817 54.5312ZM8.78868 67.1094V72.9688H7.69005H6.59142V67.1094V61.25H7.69005H8.78868V67.1094ZM10.8981 75.5C11.5426 75.7031 12.8902 77 12.8902 77.4219C12.8902 77.625 12.2897 77.6562 7.69005 77.6562C3.09044 77.6562 2.48986 77.625 2.48986 77.4219C2.48986 77.0312 3.82286 75.7188 4.39415 75.5156C5.12657 75.2656 10.1363 75.2656 10.8981 75.5ZM70.5172 75.5C71.1617 75.7031 72.5094 77 72.5094 77.4219C72.5094 77.625 71.9088 77.6562 67.3092 77.6562C62.7096 77.6562 62.109 77.625 62.109 77.4219C62.109 77.0312 63.442 75.7188 64.0133 75.5156C64.7457 75.2656 69.7555 75.2656 70.5172 75.5Z"
                  fill={
                    markingType === "printing"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M59.9854 12.1094C59.7803 12.3125 59.6191 12.6719 59.6191 12.8906C59.6191 13.1094 59.7803 13.4688 59.9854 13.6719C60.1758 13.8906 60.5127 14.0625 60.7178 14.0625C60.9229 14.0625 61.2598 13.8906 61.4502 13.6719C61.6553 13.4688 61.8164 13.1094 61.8164 12.8906C61.8164 12.6719 61.6553 12.3125 61.4502 12.1094C61.2598 11.8906 60.9229 11.7188 60.7178 11.7188C60.5127 11.7188 60.1758 11.8906 59.9854 12.1094Z"
                  fill={
                    markingType === "printing"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M59.9854 16.7969C59.7803 17 59.6191 17.3594 59.6191 17.5781C59.6191 17.7969 59.7803 18.1562 59.9854 18.3594C60.1758 18.5781 60.5127 18.75 60.7178 18.75C60.9229 18.75 61.2598 18.5781 61.4502 18.3594C61.6553 18.1562 61.8164 17.7969 61.8164 17.5781C61.8164 17.3594 61.6553 17 61.4502 16.7969C61.2598 16.5781 60.9229 16.4062 60.7178 16.4062C60.5127 16.4062 60.1758 16.5781 59.9854 16.7969Z"
                  fill={
                    markingType === "printing"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
              </svg>
            </Button>
            <Typography
              variant="subtitle1"
              color={
                markingType === "printing" ? "text.primary" : "text.secondary"
              }
            >
              Printing
            </Typography>
          </Stack>
        )}
        {embroidery && (
          <Stack gap={1} alignItems={"center"}>
            <Button
              variant={"contained"}
              onClick={() => {
                if (!selectedColor) {
                  toast.error("Veuillez d'abord sélectionner la couleur.");
                  return;
                }
                handleMarkingTypeSelect("embroidery");
              }}
              color={markingType === "embroidery" ? "primary" : "inherit"}
              sx={{
                textTransform: "none",
                border:
                  "1px solid " +
                  (markingType === "embroidery"
                    ? "transparent"
                    : theme.palette.divider),
                display: "flex",
                flexDirection: "column",
                alignItems: "center",
                width: "123px",
                boxShadow:
                  markingType === "embroidery"
                    ? theme.customShadows.primary
                    : "none",
                height: "123px!important",
              }}
            >
              <svg
                width="76"
                height="80"
                viewBox="0 0 76 80"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M21.1673 0.359383C20.6181 0.937508 20.6627 1.48438 21.3009 2.09376C21.583 2.37501 21.8205 2.75001 21.8205 2.92188C21.8205 3.79688 19.8611 4.95313 15.1705 6.81251L14.2502 7.17188L13.5673 6.10938C12.5728 4.54688 11.4447 3.98438 10.0939 4.42188C9.18844 4.71876 6.51657 6.56251 6.04157 7.21876C5.24 8.32813 5.22516 9.70313 5.98219 10.9219L6.36813 11.5156L5.53688 12.2656C3.66657 13.9688 2.12282 16.5625 1.69235 18.75C0.95016 22.4844 3.48844 26.2969 7.68922 27.7344C8.10485 27.875 8.4611 28.0156 8.4611 28.0313C8.4611 28.0625 8.16422 28.8281 7.79313 29.75C4.83922 37.1875 4.31969 44.8594 6.24938 52.7656C8.31266 61.2813 13.5673 68.9844 20.7072 73.9844C22.5181 75.25 26.1103 77.125 28.1439 77.875C35.0314 80.4219 42.572 80.6563 49.5189 78.5313C58.8259 75.6719 66.7228 68.6406 70.9533 59.4531C77.4103 45.4375 74.783 29.1875 64.2736 18.125C59.7463 13.3594 53.9127 9.82813 47.8119 8.18751C46.7283 7.89063 45.7634 7.60938 45.7041 7.56251C45.6298 7.51563 45.5705 6.54688 45.5705 5.40626C45.5705 3.42188 45.5556 3.28126 45.1548 2.48438C44.9025 1.95313 44.5017 1.46876 44.1009 1.17188C43.522 0.750008 43.3588 0.703133 42.2455 0.703133C41.1619 0.703133 40.9541 0.750008 40.4048 1.14063L39.7814 1.56251L39.158 1.14063C38.6088 0.750008 38.4009 0.703133 37.3173 0.703133C36.1892 0.703133 36.0408 0.734383 35.447 1.17188C35.1056 1.43751 34.6455 1.96876 34.4377 2.34376C34.0963 2.98438 34.0666 3.26563 33.9923 5.31251C33.9181 7.56251 33.9181 7.57813 33.547 7.68751C33.3392 7.75001 32.3002 8.04688 31.2463 8.34376C26.3181 9.70313 21.3009 12.5 17.4267 16.0469L16.358 17.0156L15.4525 15.5781L14.5619 14.1563L15.0517 13.7188C16.1205 12.7969 16.4619 11.1875 15.8681 9.89063C15.69 9.51563 15.5713 9.18751 15.6009 9.15626C15.6306 9.14063 16.4916 8.78126 17.5158 8.35938C21.3752 6.78126 23.1416 5.59376 23.765 4.15626C24.522 2.40626 23.6463 0.328133 22.058 0.0468826C21.6423 -0.0156174 21.4791 0.0312576 21.1673 0.359383ZM38.2228 3.35938L38.5939 3.73438V7.42188C38.5939 10.875 38.5791 11.1094 38.297 11.4063C37.9705 11.75 38.0002 11.75 35.4767 12.1719C29.747 13.1406 24.522 15.75 19.9205 19.9688C19.3119 20.5313 18.7775 20.9063 18.7033 20.8438C18.6439 20.7656 18.347 20.2969 18.0502 19.8125L17.5158 18.9219L18.9705 17.6563C22.9783 14.1094 27.9213 11.5313 33.3689 10.1563C35.7884 9.54688 36.2041 8.87501 36.2189 5.65626C36.2189 3.81251 36.2486 3.56251 36.5158 3.28126C36.9463 2.82813 37.7627 2.85938 38.2228 3.35938ZM43.047 3.31251C43.3142 3.62501 43.3439 3.85938 43.3439 5.68751C43.3588 8.85938 43.7744 9.53126 46.1939 10.1563C50.6025 11.2969 54.2244 12.9219 57.6236 15.3125C71.4877 25.0469 76.1486 43.6094 68.6228 59.1094C62.9228 70.8438 51.0478 78.1563 38.5939 77.6094C31.7361 77.2969 25.7244 75.0469 20.1877 70.7188C18.4806 69.375 15.3783 66.1563 14.1463 64.4531C8.34235 56.3281 6.13063 46.5781 7.95641 37.0313C8.60954 33.5781 10.3759 28.5938 10.94 28.5938C11.3259 28.5938 12.9439 28.8906 13.0181 28.9688C13.0478 29 12.8252 29.5781 12.4986 30.25C11.2369 32.8906 10.2869 36.2031 9.85641 39.3438C9.55953 41.5469 9.57438 45.7344 9.87125 47.9063C10.658 53.5625 12.9291 59.0625 16.2838 63.4375C17.3525 64.8281 20.0541 67.6094 21.3009 68.6094C27.283 73.4219 34.7345 75.7969 41.8892 75.1875C46.2088 74.8125 49.5041 73.8594 53.215 71.9219C56.1689 70.375 58.2916 68.7813 60.7705 66.25C64.897 62.0313 67.6431 57.0625 69.0384 51.3125C69.5283 49.2188 69.9588 46.1875 69.8252 45.5781C69.647 44.7188 68.3705 44.4688 67.9103 45.2188C67.8064 45.3906 67.6431 46.2188 67.5392 47.0313C66.7525 53.9844 63.3088 60.8438 58.2916 65.4844C51.6267 71.6406 42.7502 74.1719 34.215 72.3281C23.4384 70.0156 14.8291 61.125 12.4689 49.8594C11.5189 45.3125 11.6525 40.1406 12.84 35.8125C13.6416 32.8594 15.2892 29.125 15.7791 29.1563C15.9127 29.1563 16.64 29.1719 17.3673 29.1875L18.7033 29.2188L18.6142 29.6094C18.4658 30.2188 18.6736 30.75 19.1338 31.0156C19.7572 31.3438 20.3064 31.0938 20.8853 30.2188L21.3603 29.4844L22.3103 31.0313C22.8298 31.8906 24.2103 34.1094 25.3533 35.9844C26.5111 37.8594 27.4611 39.4219 27.4611 39.4531C27.4611 39.4688 27.2236 39.7656 26.9267 40.0938C26.6447 40.4375 26.1994 41.1563 25.9322 41.7188C25.4869 42.6563 25.4572 42.8438 25.4572 44.2969C25.4572 45.7188 25.5017 45.9531 25.9173 46.875L26.3627 47.8906L25.9173 48.9063C25.5017 49.8281 25.4572 50.0625 25.4572 51.4844C25.4572 52.9219 25.5017 53.1406 25.9322 54.0938C26.8525 56.125 28.5298 57.4063 30.7119 57.7031L31.8697 57.875L32.3298 58.625C33.5619 60.5781 35.9814 61.6563 38.1783 61.25C39.8853 60.9219 41.3103 59.9375 42.2603 58.4219C42.5572 57.9531 42.7353 57.8125 43.0619 57.8125C45.2142 57.8125 47.5744 56.2188 48.4798 54.1563C49.2666 52.3438 49.2666 50.6094 48.465 48.7813C48.1384 48.0469 48.1088 47.8438 48.2572 47.4844L48.4205 47.0469L49.9197 47.1406C52.5025 47.2969 54.5955 46.4531 56.258 44.5938C57.6978 42.9688 57.7869 41.9688 56.6291 40.3281C55.4564 38.6406 53.6158 37.4844 51.5822 37.1406L50.5283 36.9688L50.8697 35.9844C51.6861 33.5938 51.6564 30.8125 50.7509 28.2344C50.1572 26.5156 49.7119 25.875 48.747 25.375C48.0494 25.0156 47.8564 24.9844 47.0252 25.0781C42.6759 25.6094 39.1134 28.8125 37.7775 33.3594L37.4509 34.4531L36.4861 34.5625C34.7939 34.7344 33.2502 35.7188 32.2853 37.2344C31.8548 37.9063 31.6916 38.0469 31.3056 38.0625C31.0384 38.0781 30.5189 38.1406 30.133 38.1875L29.4205 38.2813L26.8525 34.1094C25.4423 31.7969 24.1955 29.75 24.0619 29.5469L23.8392 29.1719L24.908 29.2656C26.2884 29.4063 27.4314 29.8594 28.0548 30.5469C28.9455 31.5156 30.133 31.2031 30.133 29.9688C30.133 29.4844 30.0291 29.2656 29.5244 28.7344C28.3814 27.5313 26.3181 26.875 23.7353 26.875H22.4142L21.2267 24.9531L20.0392 23.0469L20.9595 22.125C25.1455 17.9844 30.8009 15.1875 36.8275 14.2969C37.822 14.1563 38.5939 13.9375 39.0689 13.6875L39.7814 13.2969L40.4939 13.6875C40.9689 13.9375 41.7408 14.1563 42.765 14.2969C55.3822 16.1563 65.6392 26.625 67.465 39.5C67.7025 41.1719 67.94 41.5625 68.7416 41.5625C69.7509 41.5625 69.9588 40.7344 69.558 38.3594C67.8806 28.3438 61.572 19.6719 52.6213 15.0625C49.5931 13.5156 46.3869 12.4688 43.3439 12.0313C40.8353 11.6719 40.8205 11.6563 40.8205 7.54688C40.8205 4.40626 40.9392 3.57813 41.4588 3.20313C41.9338 2.85938 42.6759 2.90626 43.047 3.31251ZM12.5877 8.82813C13.3298 10.0313 13.9533 11.1719 13.9533 11.375C13.9533 11.6406 13.6267 11.9531 12.4838 12.7344C11.6822 13.2969 10.8806 13.75 10.7173 13.75C10.4205 13.75 9.50016 12.5781 9.50016 12.2188C9.50016 12.1406 9.69313 11.9844 9.91578 11.8906C10.2572 11.7344 10.4205 11.75 10.7767 11.9375C11.5338 12.3594 12.3205 11.875 12.3205 10.9844C12.3205 10.0469 11.0439 8.28126 10.3611 8.28126C9.87125 8.28126 9.20328 8.89063 9.20328 9.32813C9.20328 9.65626 8.40172 10.2344 8.16422 10.0781C7.83766 9.85938 7.55563 9.06251 7.70407 8.76563C7.89704 8.39063 10.6877 6.54688 10.9845 6.59376C11.1033 6.62501 11.8306 7.62501 12.5877 8.82813ZM7.91188 14.0625C8.63922 15.3438 9.63375 16.0781 10.6431 16.0938C10.9103 16.0938 11.4744 15.9531 11.9048 15.7813C12.3353 15.6094 12.7213 15.5313 12.7806 15.5938C12.84 15.6563 13.2853 16.3594 13.79 17.1719C14.8142 18.8594 14.8884 18.4688 13.1517 20.5625C12.6025 21.25 11.5486 22.7188 10.8361 23.8594L9.54469 25.9219L8.34235 25.4844C5.81891 24.5625 4.37907 23.0781 3.85953 20.8906C3.51813 19.5156 4.23063 17.4375 5.67047 15.5156C6.30875 14.6719 7.34782 13.6094 7.57047 13.5938C7.615 13.5938 7.77829 13.7969 7.91188 14.0625ZM16.5955 21.75L17.2041 22.7188L16.8478 23.2031C16.4025 23.7656 14.8439 25.9219 14.547 26.375C14.3392 26.6875 14.265 26.7031 13.1072 26.5313L11.8752 26.3594L12.1275 25.9375C12.8697 24.5938 15.6603 20.7969 15.8978 20.7813C15.9572 20.7813 16.2689 21.2188 16.5955 21.75ZM19.208 25.9688L19.7572 26.875H18.4064C17.6791 26.875 17.0705 26.8281 17.0705 26.75C17.0705 26.5 18.4509 24.8281 18.5548 24.9531C18.6142 25.0156 18.9111 25.4844 19.208 25.9688ZM48.0791 27.75C48.5392 28.3594 48.9845 29.7813 49.1627 31.1875C49.4744 33.5938 48.658 36.3906 47.1142 38.25L46.4463 39.0625L45.8822 38.75C45.5705 38.5938 45.0064 38.375 44.6205 38.2656C44.2494 38.1719 43.9377 38.0313 43.9377 37.9688C43.9377 37.9063 44.6353 36.4531 45.4963 34.7344C47.1439 31.4375 47.2923 30.875 46.758 30.3125C46.4166 29.9531 45.7486 29.9063 45.3775 30.1875C45.2439 30.2969 44.4572 31.7656 43.6259 33.4375C42.7947 35.1094 42.0673 36.5469 41.9931 36.625C41.9189 36.7031 41.5923 36.5 41.2213 36.125C40.8502 35.7813 40.3603 35.3906 40.108 35.25L39.6627 35L39.8556 34.1875C40.6572 31 43.2103 28.3594 46.2533 27.5938C47.515 27.2656 47.7377 27.2969 48.0791 27.75ZM38.8759 37.25C39.5884 37.6406 40.108 38.1875 40.7166 39.2031C41.1916 39.9844 41.8298 40.3125 43.1509 40.4531C44.5759 40.625 44.947 40.7656 45.7041 41.4844C46.9064 42.6406 47.1736 44.5781 46.3423 46.2813C45.7189 47.5469 45.7189 48.2813 46.3423 49.5469C47.1884 51.25 46.8916 53.2031 45.615 54.3906C44.8728 55.0625 44.2345 55.3125 42.9877 55.4219C41.6369 55.5313 41.2213 55.7656 40.6127 56.7656C39.633 58.3594 38.6978 58.9531 37.1689 58.9531C36.0111 58.9375 34.8681 58.3438 34.3041 57.4375C34.0963 57.1094 33.6806 56.5625 33.3986 56.2188C32.8791 55.6094 32.8345 55.5938 31.5728 55.4531C30.1033 55.2969 29.4056 54.9844 28.6041 54.125C27.4908 52.9063 27.3275 51.1875 28.1736 49.375C28.7673 48.1094 28.7673 47.625 28.1884 46.4688C27.3127 44.75 27.4611 43.0313 28.6338 41.6719C29.3314 40.8594 30.1627 40.4844 31.4392 40.4063C32.7158 40.3438 33.265 40.0156 33.8588 39.0156C34.7494 37.5 35.7142 36.8906 37.2283 36.875C37.9259 36.875 38.3416 36.9688 38.8759 37.25ZM52.7103 39.9531C53.6009 40.3906 54.7588 41.4219 55.0853 42.0625C55.2931 42.4844 54.2244 43.625 53.022 44.25C52.2205 44.6719 51.8642 44.7656 50.7806 44.7969C50.083 44.8281 49.4298 44.7969 49.3408 44.7344C49.2517 44.6719 49.133 44.3125 49.0736 43.9375L48.9845 43.2656L50.9439 43.2969C52.0275 43.2969 53.022 43.2656 53.1556 43.2031C53.408 43.1094 53.7345 42.4844 53.7345 42.1094C53.7345 41.9844 53.5713 41.6875 53.3783 41.4531L53.022 41.0156L50.558 40.9688C47.8416 40.9063 47.7525 40.8594 48.5838 40.0469C49.222 39.4063 49.3259 39.375 50.6322 39.4219C51.508 39.4688 51.9681 39.5781 52.7103 39.9531Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M36.6642 17.4531C35.5509 17.6406 35.0166 18.2813 35.3134 19.1094C35.5509 19.75 35.9369 19.875 37.2877 19.75C38.2673 19.6563 38.5642 19.5781 38.8463 19.2813C39.2916 18.8125 39.2767 18.2031 38.8166 17.7344C38.4603 17.3438 37.7775 17.25 36.6642 17.4531Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M42.379 17.8907C41.9189 18.3594 41.904 18.9688 42.3493 19.4375C42.7946 19.9063 44.7985 20.2969 45.3626 20.0313C46.1642 19.6407 46.1196 18.3282 45.3032 17.9844C44.8579 17.7969 43.4626 17.5 43.0173 17.5C42.8689 17.5 42.572 17.6719 42.379 17.8907Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M30.4745 19.1406C29.2424 19.7031 28.9604 19.8906 28.7971 20.2969C28.5003 21.0469 29.0198 21.875 29.7917 21.875C30.2221 21.875 32.1073 20.9844 32.3151 20.6875C32.5971 20.2812 32.5526 19.5781 32.2112 19.2188C31.8698 18.8594 31.1721 18.8125 30.4745 19.1406Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M48.9102 19.9219C48.1681 20.6875 48.4798 21.3594 49.8751 22.1094C51.3001 22.8594 51.8345 22.8282 52.1759 21.9844C52.4876 21.1875 52.2352 20.7344 51.0626 20.0938C49.8751 19.4375 49.4001 19.3907 48.9102 19.9219Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M24.1359 23.0469C23.2453 23.8125 23.0078 24.1562 23.0078 24.6875C23.0078 25.125 23.6461 25.7812 24.0914 25.7812C24.418 25.7812 26.1844 24.4531 26.4516 24.0156C26.6742 23.6562 26.5703 23.0156 26.2289 22.6875C25.6797 22.1406 25.0859 22.2344 24.1359 23.0469Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M54.625 23.75C54.4469 23.9375 54.3281 24.2657 54.3281 24.5782C54.3281 25.0938 54.4914 25.3125 55.8422 26.5469C56.6586 27.2969 57.7422 26.8282 57.7422 25.7344C57.7422 25.3438 57.5641 25.0782 56.8219 24.3438C55.7828 23.3282 55.1742 23.1719 54.625 23.75Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M59.182 29.0625C58.9 29.2969 58.7812 29.5469 58.7812 29.875C58.7812 30.3594 59.4344 31.6407 60.0133 32.2969C60.5625 32.9375 61.6164 32.6407 61.8094 31.7969C61.9133 31.3907 61.3641 30.1094 60.7406 29.2657C60.3547 28.7344 59.6867 28.6563 59.182 29.0625Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M16.7289 33.9375C16.3578 34.2969 15.7344 36 15.7344 36.6406C15.7344 37.4687 17.0406 37.9844 17.5602 37.375C17.7086 37.2187 17.9758 36.5625 18.1836 35.9219C18.6141 34.625 18.525 34.0937 17.8719 33.7656C17.3375 33.5156 17.1297 33.5469 16.7289 33.9375Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M61.9281 35.6719C61.75 35.875 61.6016 36.1875 61.6016 36.375C61.6016 37.0156 62.0914 38.6719 62.3883 39.0156C62.9227 39.6406 63.9914 39.3594 64.1844 38.5469C64.3031 38.0469 63.7836 36 63.4422 35.6094C63.0859 35.1875 62.3289 35.2187 61.9281 35.6719Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M15.2148 41.0156C14.8734 41.3594 14.8438 41.5156 14.8438 42.7812C14.8438 44.3438 15.0516 44.7344 15.8977 44.7344C16.6844 44.7344 16.9664 44.2656 17.0406 42.75C17.1 41.5 17.0852 41.4062 16.7289 41.0312C16.2391 40.5156 15.675 40.5156 15.2148 41.0156Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M63.0562 42.5625C62.6555 42.875 62.4922 43.5157 62.4922 44.7032C62.4922 45.6563 62.5367 45.8438 62.8633 46.1719C63.3531 46.7032 64.0063 46.6875 64.407 46.1563C64.6742 45.8125 64.7188 45.5157 64.7188 44.3594C64.7188 43.0625 64.7039 42.9688 64.3328 42.6719C63.8875 42.2969 63.4273 42.2657 63.0562 42.5625Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M15.5859 48.2344C15.3335 48.5781 15.289 48.7813 15.378 49.2656C15.6898 51.2656 16.2984 52.1094 17.1741 51.7969C17.3968 51.7031 17.6788 51.4531 17.7976 51.2188C17.9905 50.8594 17.9905 50.6875 17.7234 49.5938C17.5749 48.9063 17.3226 48.2344 17.189 48.0938C16.7734 47.6563 15.9718 47.7344 15.5859 48.2344Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M62.0027 49.8125C61.6316 50.25 60.9933 52.3281 61.0972 52.7656C61.2011 53.2031 61.691 53.5938 62.1511 53.5938C62.6707 53.5938 63.1753 52.9688 63.5168 51.8906C63.9027 50.6406 63.9027 50.4531 63.5168 49.9375C63.1457 49.4375 62.3738 49.375 62.0027 49.8125Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M17.9757 54.9375C17.5601 55.4844 17.5749 55.6562 18.1093 56.7031C18.7179 57.875 18.8812 58.0781 19.3413 58.2656C20.0687 58.5625 20.7812 58.0156 20.7812 57.1719C20.7812 56.8125 19.8312 55.0469 19.4749 54.7187C19.0593 54.375 18.3171 54.4844 17.9757 54.9375Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M59.479 56.1562C59.0188 56.3594 57.9204 57.9688 57.7868 58.5938C57.6829 59.1562 58.2767 59.8438 58.8704 59.8438C59.3603 59.8438 60.1767 59 60.6962 57.9531C61.0228 57.3125 61.0376 57.1719 60.8743 56.75C60.6368 56.1562 60.0431 55.9062 59.479 56.1562Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M22.2064 60.4844C21.7908 60.8281 21.6869 61.4844 21.9689 62.0312C22.251 62.5781 23.7502 63.75 24.1807 63.75C24.7002 63.75 25.2346 63.1562 25.2346 62.5938C25.2346 61.8906 23.5275 60.1562 22.815 60.1562C22.6963 60.1562 22.4291 60.2969 22.2064 60.4844Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M54.2987 62.0469C53.8682 62.4063 53.3932 62.8282 53.2596 63C52.9034 63.4219 52.9182 64.1407 53.2893 64.5313C53.7792 65.0469 54.4174 64.9375 55.3229 64.1875C56.644 63.125 56.8667 62.5 56.1838 61.7969C55.6792 61.25 55.219 61.3125 54.2987 62.0469Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M27.4759 64.9375C26.8673 65.75 27.179 66.3594 28.5298 67.0938C29.9548 67.8594 30.504 67.8125 30.8603 66.9063C31.1572 66.1563 30.8751 65.7032 29.7025 65.0782C28.4259 64.4063 27.8915 64.375 27.4759 64.9375Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M48.4648 65.7344C47.307 66.2344 47.0547 66.4844 47.0547 67.1406C47.0547 67.7812 47.5 68.2812 48.0938 68.2812C48.5836 68.2812 50.0977 67.625 50.4984 67.2344C50.8547 66.8906 50.8398 66.0156 50.4688 65.625C50.0828 65.2187 49.5633 65.25 48.4648 65.7344Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M33.8737 67.4219C33.5026 67.9063 33.473 68.1094 33.7105 68.6563C33.9183 69.1094 34.3191 69.2969 35.5659 69.5313C36.6644 69.7344 37.1542 69.5625 37.4066 68.8906C37.5401 68.5625 37.5401 68.3594 37.3769 68.0156C37.1394 67.5 36.5159 67.25 35.1355 67.0938C34.23 67 34.1706 67.0156 33.8737 67.4219Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M41.6815 67.4844C40.7612 67.625 40.3456 68.0156 40.405 68.7188C40.4347 69.0938 40.5683 69.3594 40.8354 69.5625C41.1768 69.8438 41.3698 69.8594 42.3643 69.7656C43.7448 69.625 44.2347 69.2969 44.2347 68.5C44.2347 67.4375 43.6261 67.2031 41.6815 67.4844Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
                <path
                  d="M33.4285 42.4531C29.0496 45.9219 30.3855 52.9844 35.6996 54.4687C37.8371 55.0781 40.2863 54.3281 41.8449 52.5781C44.5168 49.6094 44.1457 44.9375 41.0433 42.4687C40.1824 41.7812 39.5144 41.6875 39.0394 42.1875C38.8761 42.3594 38.7425 42.7031 38.7425 42.9687C38.7425 43.4687 38.98 43.7812 39.9449 44.5469C40.6871 45.1406 41.2808 46.4062 41.3847 47.5781C41.6816 51.5625 37.1839 53.8594 34.423 51.1406C33.4582 50.1875 33.0574 49.25 33.0574 47.9687C33.0425 46.2969 33.5769 45.3281 35.2988 43.875C36.0855 43.2031 35.7293 42 34.705 41.9062C34.3043 41.875 34.0371 41.9844 33.4285 42.4531Z"
                  fill={
                    markingType === "embroidery"
                      ? "#fff"
                      : theme.palette.text.secondary
                  }
                />
              </svg>
            </Button>
            <Typography
              variant="subtitle1"
              color={
                markingType === "embroidery" ? "text.primary" : "text.secondary"
              }
            >
              Embroidery
            </Typography>
          </Stack>
        )}
      </Stack>

      {/* Marking Location */}
      <Collapse in={Boolean(markingType)}>
        <Typography
          variant="subtitle1"
          color="text.secondary"
          sx={{
            mt: 4,
            mb: 1,
            textTransform: "uppercase",
          }}
        >
          SÉLECTIONNEZ L’ENDROIT DU MARQUAGE
        </Typography>

        <Grid container spacing={4}>
          {markingType
            ? (markingType === "embroidery"
                ? embroideryPositions
                : printingPositions
              )?.map((option: Option) => (
                <Grid size={{ xs: 6, md: 4, lg: 3 }} key={option.name}>
                  <Stack gap={1} alignItems={"center"}>
                    <Button
                      variant={
                        markingLocations.includes(option)
                          ? "contained"
                          : "outlined"
                      }
                      onClick={() => handleMarkingLocationSelect(option)}
                      sx={{
                        minHeight: "120px",
                        boxShadow: markingLocations.includes(option)
                          ? theme.customShadows.primary
                          : "none",
                        border:
                          "1px solid " +
                          (markingLocations.includes(option)
                            ? "transparent"
                            : theme.palette.divider),
                        display: "flex",
                      }}
                    >
                      <Box
                        sx={{
                          position: "relative",
                          height: 100,
                          width: 100,
                        }}
                      >
                        <Image
                          src={option.cover.url}
                          alt={option.name}
                          fill
                          objectFit="cover"
                          priority
                        />
                      </Box>
                    </Button>
                    <Typography
                      variant="subtitle1"
                      color={
                        markingLocations.includes(option)
                          ? "text.primary"
                          : "text.secondary"
                      }
                    >
                      {capitalize(option.name)}
                    </Typography>
                  </Stack>
                </Grid>
              ))
            : null}
        </Grid>
      </Collapse>
      <Collapse in={markingLocations.length > 0}>
        <Typography fontWeight={500} variant="body1" mt={2}>
          Prix du produit avec le marquage <br />
          <b>{fCurrency(totalPrice)}</b>
        </Typography>
        <Typography fontWeight={500} variant="body1">
          Prix total à partir de (TTC)
          <br />
          <b>{fCurrency((priceSale + totalPrice) * quantity)}</b>
        </Typography>
      </Collapse>
    </Box>
  );
}
